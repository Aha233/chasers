# #define用法  
## 如何定义宏、取消宏  
### 定义宏  
```cpp
#define [MacroName] [MacroValue]
```
#define是C语言中的一个预处理指令。主语在语句末尾没有 `;` 。  
其中的 `#` 表示这是一条预处理命令，凡是以 `#` 开头的均为预处理命令。  
`define` 为宏定义命令。  
`MacroName` 为所定义的宏名。在编译预处理时，对程序中所有出现的宏名，都用宏定义中的字符串去代换，这称为“宏代换”或“宏展开”。  
`MacroValue` 为所定义的常量值，常量值只能是字符串或数字。  
如：  
```cpp
#define MAXTIME 1000//将MAXTIME定义为1000，MAXTIME为所定义的宏名。
```
如果在程序里面写：  
```cpp
if(i<MAXTIME)
{
    //do something.
}
```
编译器在处理这个代码之前会对MAXTIME进行处理替换为1000。  

这样的定义看起来类似于普通的常量定义CONST，但也有着不同，因为define的定义更像是简单的文本替换，而不是作为一个量来使用。  

### 带参数的宏  
define可以像函数那样接受一些参数，如下:  
```cpp
#define max(x,y) (x)>(y)?(x):(y);
```
这个定义就将返回两个数中较大的那个。即将max定义为 `x` 与 `y` 中的较大值。  

但是这样做的话存在隐患，例子如下：  
```cpp
#define Add(a,b) a+b;
```
在一般使用的时候是没有问题的，但是如果遇到如： `c * Add(a,b) * d` 的时候就会出现问题，代数式的本意是a+b然后去和c、d相乘，但是因为使用了define（它只是一个简单的替换），所以式子实际上变成了 `c*a + b*d` 。  

另外举一个例子：  
```cpp
#define pin (int*);
pin a,b;
```
本意是a和b都是int型指针，但是实际上变成int* a,b;  
a是int型指针，而b是int型变量。  
这时应该使用typedef来代替define，这样a和b就都是int型指针了。  

所以我们在定义的时候，养成一个良好的习惯，建议所有的层次都要加括号。  

### 取消宏
```cpp
#undef [MacroName]
```

## 宏的单行定义  
define 中的 `#`  以及 `##`  一般是用来拼接字符串的，但是在实际使用过程中，有一些细微的差别呢。  
1、#是字符串化的意思，出现在宏定义中的#是把跟在后面的参数转成一个字符串。  
2、##是连接符号，把参数连接在一起。  
如：  
```cpp
#define A(x) T_##x
#define B（x) #@x
#define C（x) #x
```
我们假设：x=1，则有：
>A(1)------〉T_1  
>B(1)------〉'1'  
>C(1)------〉"1"  

## #typedef与#define的区别  
 typedef是为了增加可读性而为标识符另起的新名称(仅仅只是个别名)，而#define原本在C中是为了定义常量， 到了C++，const、enum、inline的出现使它也渐渐成为了起别名的工具。  
>一般都遵循 `#define` 定义“可读”的常量以及一些宏语句的任务。  
>而 `typedef` 则常用来定义关键字、冗长的类型的别名。  

宏定义只是简单的字符串代换(原地扩展)，而typedef则不是原地扩展，它的新名字具有一定的封装性，以致于新命名的标识符具有更易定义变量的功能。  
